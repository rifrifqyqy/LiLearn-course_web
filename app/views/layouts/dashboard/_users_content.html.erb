<%# user content section %>
<script>
  function togglePassword(button) {
    const userId = button.getAttribute('data-user-id');
    const passwordField = document.getElementById(`password-${userId}`);
    const eyeIcon = document.getElementById(`icon-eye-${userId}`);
    const eyeSlashIcon = document.getElementById(`icon-eye-slash-${userId}`);

    // fungsi sembunyikan semu
    document.querySelectorAll("[id^='password-']").forEach(field => {
      if (field.id !== `password-${userId}` && !field.textContent.includes('*')) {
        const otherUserId = field.id.split('-')[1];
        field.textContent = '*'.repeat(field.getAttribute('data-password').length);
        document.getElementById(`icon-eye-${otherUserId}`).classList.remove('hidden');
        document.getElementById(`icon-eye-slash-${otherUserId}`).classList.add('hidden');
      }
    });

    // Toggle the selected password visibility
    if (passwordField.textContent.includes('*')) {
      // Show password
      passwordField.textContent = passwordField.getAttribute('data-password');
      eyeIcon.classList.add('hidden');
      eyeSlashIcon.classList.remove('hidden');
    } else {
      // Hide password
      passwordField.textContent = '*'.repeat(passwordField.getAttribute('data-password').length);
      eyeIcon.classList.remove('hidden');
      eyeSlashIcon.classList.add('hidden');
    }
  }
</script>



<style>
  .hidden {
    display: none;
  }
</style>

<%# meta tag name %>
<% content_for :title, "Li-Learnv | Users Data" %>

<section class="p-8">
  <table class="min-w-full bg-white ring-1 ring-gray-300 rounded-2xl overflow-hidden p-2">
    <thead>
      <tr>
        <th class="py-4 text-start px-4">
          <h1>Users Data</h1>
        </th>
      </tr>
    </thead>
    <thead>
      <tr class="bg-gray-100 text-gray-700 capitalize text-sm leading-normal border-y border-gray-300">
        <th class="py-3 text-start px-4">ID</th>
        <th class="py-3 text-start px-4">Username</th>
        <th class="py-3 text-start px-4">Password</th>
        <th class="py-3 text-start px-4">Roles</th>
        <th class="py-3 text-start px-4">Terakhir Login</th>
        <th class="py-3 text-start px-4">Tanggal Dibuat</th>
      </tr>
    </thead>
    <tbody class="text-gray-600 text-sm font-light">
      <% @onlyuser.each do |user| %>
      <tr class="even:border-y even:border-zinc-200 hover:bg-amber-100 transition-all duration-200">
        <td class="px-4 py-4">
          <p class=""><%= user.id %></p>
        </td>
        <td class="px-4 py-4">
          <p class=""><%= user.username %></p>
        </td>

        <td class="px-4 py-4 flex gap-2 items-center transition-all duration-300">
          <button type="button" data-user-id="<%= user.id %>" onclick="togglePassword(this)" class="ml-2 text-zinc-500 hover:underline">
            <svg id="icon-eye-<%= user.id %>" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.522 5 12 5s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7s-8.268-2.943-9.542-7z" />
            </svg>
            <svg id="icon-eye-slash-<%= user.id %>" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 3l18 18M9.598 9.598A4.5 4.5 0 014.5 12c1.274 4.057 5.064 7 9.542 7 1.84 0 3.573-.474 5.05-1.305M6.343 6.343a9.956 9.956 0 00-3.885 3.885M21 12a9.956 9.956 0 01-3.885 3.885" />
            </svg>
          </button>
          <span id="password-<%= user.id %>" data-password="<%= user.password %>"><%= '*' * user.password.length %></span>
        </td>
        <td class="px-4 py-4">
          <p class="mx-auto bg-amber-100 px-3 text-amber-600 font-medium rounded-lg inline-block "><%= user.role %></p>
        </td>

        <td class="px-4 py-4">
          <%= user.last_login.present? ? time_ago_in_words(user.last_login) + ' yang lalu' : 'Belum pernah login' %>
        </td>
        <td class=" px-4 py-4"><%= user.created_at.strftime("%d %B %Y") %></td>
      </tr>
      <% end %>
    </tbody>
  </table>
</section>