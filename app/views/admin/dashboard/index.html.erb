<%# style %>
<% btn_dashboard = "text-zinc-800 py-3 rounded-xl font-semibold hover:bg-zinc-200 transition-all flex gap-4 items-center px-4"%>
<%# style end %>


<main class="grid grid-cols-5 bg-white">
  <nav class="p-4 h-screen col-span-1">
    <section class="bg-white h-full rounded-2xl flex flex-col px-8 border border-zinc-300">
      <h1 class="text-3xl font-semibold uppercase w-fit mx-auto mt-8"><span class="text-amber-500">Li</span>learnv
      </h1>
      <ul class="mt-16   flex flex-col gap-4">
        <button class="<%= full_button_classes('dashboard') %>" id="dashboard" onclick="setButtonId('dashboard')">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24">
            <path fill="currentColor" d="M4 13h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1m0 8h6c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1m10 0h6c.55 0 1-.45 1-1v-8c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1M13 4v4c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1" />
          </svg>
          <p>Dashboard</p>
        </button>
        <button class="<%= full_button_classes('admin') %>" id="admin" onclick="setButtonId('admin')">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24">
            <path fill="currentColor" d="M17 11c.34 0 .67.04 1 .09V6.27L10.5 3L3 6.27v4.91c0 4.54 3.2 8.79 7.5 9.82c.55-.13 1.08-.32 1.6-.55c-.69-.98-1.1-2.17-1.1-3.45c0-3.31 2.69-6 6-6" />
            <path fill="currentColor" d="M17 13c-2.21 0-4 1.79-4 4s1.79 4 4 4s4-1.79 4-4s-1.79-4-4-4m0 1.38c.62 0 1.12.51 1.12 1.12s-.51 1.12-1.12 1.12s-1.12-.51-1.12-1.12s.5-1.12 1.12-1.12m0 5.37c-.93 0-1.74-.46-2.24-1.17c.05-.72 1.51-1.08 2.24-1.08s2.19.36 2.24 1.08c-.5.71-1.31 1.17-2.24 1.17" />
          </svg>
          <p>Admin</p>
        </button>
        <button class="<%= full_button_classes('users') %>" id="users" onclick="setButtonId('users')">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12 4a4 4 0 0 1 4 4a4 4 0 0 1-4 4a4 4 0 0 1-4-4a4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4" />
          </svg>
          <p>Users</p>
        </button>
        <button class="<%= full_button_classes('course') %>" id="course" onclick="setButtonId('course')">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4s8-1.79 8-4s-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4" />
          </svg>
          <p>Courses</p>
        </button>
      </ul>
    </section>
  </nav>

  <section class="col-span-4 h-screen overflow-y-scroll py-4 px-8">
    <nav class="w-full flex bg-white shadow-sm sticky top-0 py-4 px-8 rounded-2xl z-50 justify-between border border-zinc-300">
      <h2 class="font-semibold text-zinc-800 text-3xl"></h2>
      <h1 class="w-fit ml-auto">
        <div>
          <%= button_tag id: "profile-button", class: "#{current_user.role == 'admin' ? 'bg-amber-600' : 'bg-black'} rounded-full text-white p-2 py-1 flex justify-center items-center gap-2 hover:opacity-80" do %>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-8">
            <path fill="white" d="M12 11.385q-1.237 0-2.119-.882T9 8.385t.881-2.12T12 5.386t2.119.88t.881 2.12t-.881 2.118t-2.119.882m-7 7.23V16.97q0-.619.36-1.158q.361-.54.97-.838q1.416-.679 2.834-1.018q1.417-.34 2.836-.34t2.837.34t2.832 1.018q.61.298.97.838q.361.539.361 1.158v1.646z" />
          </svg>
          <p class="mr-2 capitalize font-semibold"><%= current_user.username %></p>
          <% end %>

          <!-- Dropdown Options -->
          <div id="profile-options" class="absolute right-0 mt-2 w-[320px] p-2 bg-white border border-gray-300 rounded-lg shadow-lg hidden">
            <a href="/profile" class="block p-4 text-gray-700 hover:bg-gray-200 rounded-md transition-all">Profile Settings</a>
            <% if admin? %>
            <% end %>
            <div id="logout-container" class="flex gap-2 p-4 items-center w-full hover:bg-gray-200 transition-all cursor-pointer rounded-md">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path fill="red" d="M5.616 20q-.691 0-1.153-.462T4 18.384V5.616q0-.691.463-1.153T5.616 4h6.403v1H5.616q-.231 0-.424.192T5 5.616v12.769q0 .23.192.423t.423.192h6.404v1zm10.846-4.461l-.702-.72l2.319-2.319H9.192v-1h8.887l-2.32-2.32l.702-.718L20 12z" />
              </svg>
              <p class="text-gray-700">Logout</p>
              <%= button_to "Logout", logout_path, method: :delete, id: "logout-button", class: "block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-200 hidden" %>
            </div>
            <%# jika admin maka munculkan %>
          </div>
        </div>
      </h1>
    </nav>

    <% current_button_id = params[:button_id] || 'dashboard' %>

    <% case current_button_id %>
    <% when 'course' %>
    <%= render 'layouts/dashboard/courses_content', locals: { courses: @courses } %>
    <% when 'dashboard' %>
    <%= render 'layouts/dashboard/dashboard_content' %>
    <% when 'admin' %>
    <%= render 'layouts/dashboard/admin_content' %>
    <% when 'users' %>
    <%= render 'layouts/dashboard/users_content' %>
    <% else %>
    <%= render 'layouts/dashboard/dashboard_content' %>
    <% end %>
</main>


<script>
  function setButtonId(buttonId) {
    const url = new URL(window.location.href);
    url.searchParams.set('button_id', buttonId);
    url.searchParams.delete('page');
    window.location.href = url.toString();
  }
  document.addEventListener("DOMContentLoaded", function() {
    const profileButton = document.getElementById("profile-button");
    const profileOptions = document.getElementById("profile-options");

    // Toggle dropdown visibility when the button is clicked
    profileButton.addEventListener("click", function(e) {
      e.preventDefault();
      profileOptions.classList.toggle("hidden");
    });

    // Optionally: Close the dropdown if clicked outside
    document.addEventListener("click", function(e) {
      if (!profileButton.contains(e.target) && !profileOptions.contains(e.target)) {
        profileOptions.classList.add("hidden");
      }
    });
  });

  // logout trigger div logic
  document.addEventListener("DOMContentLoaded", function() {
    const logoutContainer = document.getElementById("logout-container");
    const logoutButton = document.getElementById("logout-button");

    logoutContainer.addEventListener("click", function() {
      logoutButton.click();
    });
  });

  // navbar changing color
  document.addEventListener("DOMContentLoaded", function() {
    const navbar = document.getElementById("navbar");

    window.addEventListener("scroll", function() {
      if (window.scrollY > 0) {
        navbar.classList.add("bg-zinc-800", "text-white");
        navbar.classList.remove("bg-white");
      } else {
        navbar.classList.add("bg-white");
        navbar.classList.remove("bg-zinc-800", "text-white");
      }
    });
  });

  // Menunav changing color untuk semua elemen dengan class "menu-nav"
  document.addEventListener("DOMContentLoaded", function() {
    const menuNavs = document.querySelectorAll(".menu-nav");

    window.addEventListener("scroll", function() {
      menuNavs.forEach(menuNav => {
        if (window.scrollY > 0) {
          menuNav.classList.add("hover:bg-zinc-600", "text-white");
          menuNav.classList.remove("bg-white", "text-zinc-800", "hover:bg-zinc-200");
        } else {
          menuNav.classList.add("hover:bg-zinc-200", "text-zinc-800");
          menuNav.classList.remove("hover:bg-zinc-600", "text-white");
        }
      });
    });
  });
</script>