<div class="container mx-auto py-8 px-4">
  <div class="bg-white rounded-lg shadow-md p-6">
    <div class="flex flex-col md:flex-row gap-6">
      <!-- Thumbnail -->
      <img src="<%= @course.thumbnail %>" class="w-full md:w-1/3 h-full aspect-video rounded-lg object-cover" alt="<%= @course.title %> Thumbnail">

      <!-- Course Information -->
      <div class="flex-1">
        <h1 class="text-3xl font-semibold mb-4"><%= @course.title %></h1>
        <p class="text-gray-600 mb-6"><%= @course.description %></p>

        <!-- Materials Section -->
        <% if @materials.present? %>
        <h2 class="text-2xl font-semibold mb-4">Materials</h2>
        <ul class="space-y-3">
          <% @materials.each do |material| %>
          <li class="p-3 bg-gray-100 rounded-lg">
            <h3 class="text-xl font-medium"><%= material.title %></h3>
            <p class="text-gray-500 line-clamp-2"><%= material.description %></p>
            <p class="text-gray-500 line-clamp-2"><%= raw material.content %></p>
          </li>
          <% end %>
        </ul>
        <% else %>
        <p class="text-gray-500">No materials available for this course.</p>
        <% end %>
      </div>
    </div>

    <!-- Comments and Rating Section -->
    <div class="mt-8">
      <h2 class="text-2xl font-semibold mb-4">Comments & Ratings</h2>
      <!-- Form to Add Comment and Rating -->
      <% if current_user %>
      <%= form_with model: [@course, @course.reviews.build], local: true do |f| %>
      <div class="mb-4">
        <%= f.label :rating, "Rating (1-5)", class: "block text-sm font-medium text-gray-700" %>
        <%= f.number_field :rating, in: 1..5, step: 1, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
      </div>

      <div class="mb-4">
        <%= f.label :content, "Comment", class: "block text-sm font-medium text-gray-700" %>
        <%= f.text_area :content, rows: 3, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
      </div>

      <%= f.submit "Submit", class: "px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" %>
      <% end %>
      <% else %>
      <p class="text-gray-500 mt-4">Please log in to leave a comment and rating.</p>
      <% end %>
      <!-- Display Average Rating -->
      <p class="text-yellow-500 font-bold">Average Rating: <%= @course.average_rating %>/5</p>
      <!-- Display Existing Comments -->
      <% if @course.reviews.count > 0 %>
      <ul class="mt-6 space-y-4">
        <% @course.reviews.each do |review| %>
        <li class="p-4 bg-gray-100 rounded-lg">
          <p class="text-yellow-500 font-bold">Rating: <%= review.rating || "N/A" %>/5</p>
          <p class="text-gray-800"><%= review.content %></p>
          <p class="text-sm text-gray-500">
            Posted on <%= review.created_at ? review.created_at.strftime("%d %B %Y") : "Date not available" %>
            by <%= review.user ? review.user.username : "User not available" %>
          </p>
        </li>
        <% end %>
      </ul>
      <% else %>
      <p class="text-gray-500 mt-4">No comments available for this course.</p>
      <% end %>

    </div>
  </div>
</div>